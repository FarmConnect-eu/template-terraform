#cloud-config
# Basic cloud-init configuration
# Auto-generated by proxmox-debian-vm wrapper module

hostname: ${hostname}
manage_etc_hosts: true
timezone: Europe/Paris
locale: fr_FR.UTF-8

users:
  - name: ${ci_user}
    groups: sudo
    shell: /bin/bash
    sudo: ['ALL=(ALL) NOPASSWD:ALL']
    lock_passwd: false
    passwd: ${ci_password}
    ssh_authorized_keys:
%{ for key in ssh_keys ~}
      - ${key}
%{ endfor ~}

disable_root: true
ssh_pwauth: true

package_update: false
package_upgrade: false

# Resize root filesystem to use full disk
growpart:
  mode: auto
  devices: ['/']
  ignore_growroot_disabled: false

runcmd:
  - echo "Cloud-init completed for ${hostname}" > /var/log/cloud-init-complete
